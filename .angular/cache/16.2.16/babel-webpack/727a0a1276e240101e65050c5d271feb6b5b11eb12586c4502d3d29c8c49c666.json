{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./product.service\";\nexport class FilterService {\n  constructor(productService) {\n    this.productService = productService;\n    this.filteredProducts = new BehaviorSubject([]);\n    this.filterList = new BehaviorSubject([]);\n    this.category = '';\n  }\n  filterProduct(products) {\n    return this.filteredProducts.next(products);\n  }\n  getProductTypeFilter(category) {\n    let prodTypes = [];\n    this.category = category;\n    this.productService.getByCategory(category).subscribe(data => {\n      this.products = data;\n      this.cloneOfProducts = data;\n      const types = [...new Set(this.cloneOfProducts.map(item => item.type))];\n      types.map((prod, index) => {\n        return prodTypes.push({\n          label: prod,\n          value: prod,\n          checked: false,\n          id: index + 1\n        });\n      });\n      this.filterList.next(prodTypes);\n    }, error => error);\n  }\n  handlePriceFilter(min, max) {\n    const products = this.cloneOfProducts.filter(item => item.price >= min && item.price <= max);\n    this.filterProduct(products);\n  }\n  handleCatFilter(checkedItems) {\n    this.productService.getByCategory(this.category).subscribe(data => this.products = data);\n    this.filterProduct(this.products);\n    let checked = checkedItems.filter(item => item.checked).map(item => item.value);\n    if (checked.length) {\n      this.filteredProducts.subscribe(data => {\n        this.products = data.filter(item => checked.includes(item.type));\n      });\n    }\n    return this.products;\n  }\n  handleRateFilter(rating) {\n    this.productService.getByCategory(this.category).subscribe(data => this.products = data);\n    this.filterProduct(this.products);\n    this.filteredProducts.subscribe(data => {\n      this.products = data.filter(item => rating <= Math.trunc(item.rating.rate));\n    });\n    return this.products;\n  }\n  static {\n    this.ɵfac = function FilterService_Factory(t) {\n      return new (t || FilterService)(i0.ɵɵinject(i1.ProductService));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: FilterService,\n      factory: FilterService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","FilterService","constructor","productService","filteredProducts","filterList","category","filterProduct","products","next","getProductTypeFilter","prodTypes","getByCategory","subscribe","data","cloneOfProducts","types","Set","map","item","type","prod","index","push","label","value","checked","id","error","handlePriceFilter","min","max","filter","price","handleCatFilter","checkedItems","length","includes","handleRateFilter","rating","Math","trunc","rate","i0","ɵɵinject","i1","ProductService","factory","ɵfac","providedIn"],"sources":["D:\\Projects All\\Angular\\ng-ecommerce-master\\src\\app\\modules\\product\\services\\filter.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport {BehaviorSubject, Subject} from 'rxjs';\nimport { CategoryFilter, Product } from '../model';\nimport { ProductService } from './product.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FilterService {\n  public filteredProducts=new BehaviorSubject<Product[]>([]);\n  filterList=new BehaviorSubject<CategoryFilter[]>([]);\n  products!:Product[];\n  category='';\n  cloneOfProducts!:Product[];\n  constructor(private productService:ProductService) { }\n\n  filterProduct(products:Product[]){\n    return this.filteredProducts.next(products);\n  }\n\n  getProductTypeFilter(category:string){\n    let prodTypes:CategoryFilter[]=[];\n    this.category=category;\n    this.productService.getByCategory(category).subscribe(data=>{\n      this.products=data\n      this.cloneOfProducts=data\n      const types=[...new Set(this.cloneOfProducts.map(item=>item.type))];\n      types.map((prod,index)=>{\n        return prodTypes.push({\n        label:prod,\n        value:prod,\n        checked:false,\n        id:index+1\n      })});\n      this.filterList.next(prodTypes);\n    },error=>error)\n  }\n\n  handlePriceFilter(min:number,max:number){\n    const products=this.cloneOfProducts.filter(item=>item.price>=min&&item.price<=max);\n    this.filterProduct(products);\n  }\n  handleCatFilter(checkedItems:CategoryFilter[]):Product[]{\n    this.productService.getByCategory(this.category).subscribe(data=>this.products=data);\n    this.filterProduct(this.products);\n    let checked=checkedItems.filter(item=>item.checked).map(item=>item.value);\n    if(checked.length){\n      this.filteredProducts.subscribe((data:Product[])=>{\n        this.products=data.filter(item=>checked.includes(item.type));\n      })\n    } \n    return this.products;\n\n  }\n  handleRateFilter(rating:number):Product[]{\n    this.productService.getByCategory(this.category).subscribe(data=>this.products=data);\n    this.filterProduct(this.products);\n    this.filteredProducts.subscribe((data:Product[])=>{\n     this.products= data.filter(item=>rating<=Math.trunc(item.rating.rate));\n    })\n    return this.products;\n  }\n\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}